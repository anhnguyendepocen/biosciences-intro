---
title: "Do mosquitoes like beer?"
output:
  html_document:
    df_print: paged
---

This notebook is an analysis of the data from [this paper](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0009546).

It implements the logic and analysis from this excellent talk by John Rauser: [Statistics without the agonizing pain](https://www.youtube.com/watch?v=5Dnw46eC-0o)

This document is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

You can execute chunks like the one below by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

The chunk below records the numbers of mosquitoes attracted to each of the 25 beer drinkers, and puts these into the variable `beer_attract`.

```{r}
# The number of mosquitoes attracted to each beer drinker, typed in from
# the slides in the video above, at about 3.39 in.
beer_attract = c(27, 20, 21, 26, 27, 31, 24, 21, 20,
                 19, 23, 24, 28, 19, 24, 29, 18,
                 20, 17, 31, 20, 25, 28, 21, 27)
# Show the values
beer_attract
```

Check we do in fact have 25 beer drinkers:

```{r}
length(beer_attract)
```

The number of mosquitoes attracted to each of the 18 water drinkers.

```{r}
# The number of mosquitoes attracted to each water drinker, typed in from
# the slides in the video above, at about 3.39 in.
water_attract = c(21, 22, 15, 12, 21, 16,
                 19, 15, 22, 24, 19, 23,
                 13, 22, 20, 24, 18, 20)
# Show the values
water_attract
```

Check that we do in fact have 18 water drinkers:

```{r}
length(water_attract)
```

Now we repeat the analysis in the video.

```{r}
# Mean number of mosquitoes per beer drinker
beer_mean = mean(beer_attract)
beer_mean
```

```{r}
# Mean number of mosquitoes per water drinker
water_mean = mean(water_attract)
water_mean
```

The difference in means:

```{r}
observed_mean_diff = beer_mean - water_mean
observed_mean_diff
```

This is the difference we observe - about 4.4.  Could this reasonably have come about by chance?   By *chance* we mean, could we have observed this difference if there was, in fact, no underlying difference between the number of mosquitoes attracted to the beer drinkers, and the number attracted to the water drinkers.

We simulate this situation by throwing all the mosquito counts into one big unlabeled group, with 25 + 18 = 43 members.

```{r}
# We put all counts into one group by concatenating the two lists, with "c"
pooled = c(beer_attract, water_attract)
pooled
```

```{r}
# We expect the pooled group to have 25 + 18 = 43 members
length(pooled)
```

The first 25 values in `pooled` are the beer drinker counts, and the last 18 are the water drinker counts.

Now we shuffle this group to a random order:

```{r}
# We shuffle the counts, so they are now a random mix of beer and water
shuffled = sample(pooled)
shuffled
```

We can take the first 25 values to be counts for our new fake beer drinkers, and the last 18 to be counts for our new fake water drinkers.  In fact, of course, each group is a random mix of beer and water drinkers:

```{r}
# The first 25 values
fake_beer = head(shuffled, 25)
# The last 18 values
fake_water = tail(shuffled, 18)
```

Now we calculate our means, and mean difference, to get a mean from the situation where there is no underlying difference between the groups:

```{r}
fake_mean_diff = mean(fake_beer) - mean(fake_water)
fake_mean_diff
```

This value is less than than the 4.4ish difference we see for the original, correctly labeled counts.   Was that just a fluke?  We just repeat the process 10000 times, to see what the spead of the fake differences looks like:

```{r}
# Make an list of zeros to store our fake differences
fake_mean_diffs = numeric(10000)
# Repeat 10000 times
for (i in 1:10000) {
  # Repeat the same operations as we did above
  shuffled = sample(pooled)
  fake_beer = head(shuffled, 25)
  fake_water = tail(shuffled, 18)
  fake_mean_diff = mean(fake_beer) - mean(fake_water)
  # Store the fake difference in our list 
  fake_mean_diffs[i] = fake_mean_diff
}
```

If you ran this yourself, you'll notice that it takes a fraction of a second.

Let's look at the spread of mean differences we see:

```{r}
hist(fake_mean_diffs)
```

The difference we saw was about 4.4.  It looks like a value that large happens very rarely by chance.  We can check how often it occured in our 10000 trials with:

```{r}
count = sum(fake_mean_diffs >= observed_mean_diff)
count
```

As a proportion of all 10000 trials, that is:

```{r}
p = count / 10000
p
```

So, the probability that we would see a value of about 4.4 or greater, if there really was no difference between the beer and water drinkers, is in the order of 0.0005 - very low.
